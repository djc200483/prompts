# ðŸš‚ Railway Deployment Guide

## Quick Fix for Current Issues

### 1. **Redeploy with Fixed Configuration**

The deployment issues have been fixed. Here's what to do:

1. **Push the updated code to GitHub**:
   ```bash
   git add .
   git commit -m "Fix Railway deployment configuration"
   git push origin master
   ```

2. **In Railway Dashboard**:
   - Go to your project settings
   - **Root Directory**: Set to `backend`
   - **Build Command**: Leave empty (uses railway.json)
   - **Start Command**: Leave empty (uses railway.json)

### 2. **Environment Variables Check**

Make sure these are set in Railway:
```bash
DATABASE_URL=postgresql://... (auto-generated by Railway)
ADMIN_USERNAME=djc200483
ADMIN_PASSWORD=Is@k14@NUFC
API_KEY=your_generated_api_key
NODE_ENV=production
PORT=3000
FRONTEND_DOMAIN=https://prompts.oddesthistory.com
```

### 3. **Database Setup**

1. In Railway dashboard, add a **PostgreSQL** database
2. Railway will automatically provide the `DATABASE_URL`
3. The app will automatically create tables on first startup

### 4. **Test Deployment**

After redeployment, test these URLs:
- **Health Check**: `https://prompts-production-7afc.up.railway.app/api/health`
- **Admin Panel**: `https://prompts-production-7afc.up.railway.app/admin`
- **API Root**: `https://prompts-production-7afc.up.railway.app/`

## What Was Fixed

1. âœ… **Vercel CLI Conflict**: Removed any Vercel dependencies
2. âœ… **Railway Configuration**: Updated railway.json with proper schema
3. âœ… **Node.js Deprecation**: Made migration script more robust
4. âœ… **Database Connection**: Added graceful handling for missing DATABASE_URL
5. âœ… **Build Process**: Simplified build commands
6. âœ… **Error Handling**: Added retry logic for server startup

## Troubleshooting

### If Still Failing:

1. **Check Railway Logs**:
   - Go to Railway dashboard â†’ Deployments â†’ View logs
   - Look for specific error messages

2. **Verify Environment Variables**:
   - Make sure all required variables are set
   - Check that DATABASE_URL is properly formatted

3. **Manual Restart**:
   - In Railway dashboard, click "Redeploy"
   - This will trigger a fresh build

### Common Issues:

- **Port Issues**: Railway automatically sets PORT=3000
- **Database Connection**: Wait for PostgreSQL to be fully provisioned
- **Build Failures**: Check that all dependencies are in package.json

## Expected Behavior

After successful deployment:
1. âœ… Server starts on port 3000
2. âœ… Database tables are created automatically
3. âœ… Health check endpoint responds
4. âœ… Admin panel is accessible with your credentials
5. âœ… API endpoints are ready for frontend integration

---

**Need Help?** Check Railway logs for specific error messages and let me know what you see!
